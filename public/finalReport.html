<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Report</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/finalReport.css">
    <script src="js/inputDigest.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src=" https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script type = "text/javascript" src = "js/finalReportScript.js"></script>
</head>
<body onload="retrieveData()">
    <nav class="navbar navbar-expand-lg navbar-inverse navbar-fixed-top topbar">
        <div class="container-fluid">
            <img src="css/snakes.jpg" style="width: 5%; height: 5%" class="img-circle" alt="logo">
            <a class="title">Final Report</a>

        </div>
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navHeaderCollapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="navHeaderCollapse">
                <ul class="nav navbar-nav">
                    <li class="nav-item"><a href="home.html">Home</a></li>
                    <li class="nav-item"><a href="history.html">History</a></li>
                    <li class="nav-item"><a href="help.html">Help</a></li>
                </ul>
            </div>
        </div>
    </nav>

<div class = "container-fluid">

<div class="row row-one">
  <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4" >
   <div class="panel panel-default" id = "panel1">
    <div class="panel-heading">IV Madication Defibliration</div>
    <div class="panel-body">Comments: <p>Doctors Comments about the UV</p></div>

    <div class="panel-footer">
    <button type="button" data-toggle = "modal" data-target= "#editModal" class="btn btn-primary edit-button" data-panel = "1">Edit</button>
    </div>
  </div>

  </div>
    <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4" >
   <div class="panel panel-default" id = "panel2">
    <div class="panel-heading">General</div>
    <div class="panel-body">Date: <p></p></div>
    <div class="panel-body">Time: <p></p></div>
    <div class="panel-body">Location: <p></p></div>
    <div class="panel-body">Time event called: <p></p></div>
    <div class="panel-body">Time team arrived: <p></p></div>
    <div class="panel-body">Witnesses: <p></p></div>
    <div class="panel-body">CPR Initiated: <p></p>></div>
    <div class="panel-body">Time of compression: <p></p></div>
       <div class="panel-footer">
    <button type="button" data-toggle = "modal" data-target= "#editModal" class="btn btn-primary edit-button" data-panel = "2">Edit</button>
       </div>
  </div>

  </div>
   <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4" >
   <div class="panel panel-default" id = "panel3">
    <div class="panel-heading">Patient Information</div>
    <div class="panel-body">Name: <p></p></div>
    <div class="panel-body">Date of Birth: <p></p></div>
    <div class="panel-body">MR#: <p></p></div>
    <div class="panel-body">Weight: <p></p></div>
    <div class="panel-body">Family Notified: <p></p></div>
    <div class="panel-body">Comments: <p></p></div>

       <div class="panel-footer">
    <button type="button" data-toggle = "modal" data-target= "#editModal" class="btn btn-primary edit-button" data-panel = "3">Edit</button>
       </div>
  </div>

  </div>
</div>

<div class="row row-two">
    <div class = "col-xs-12 col-sm-12 col-md-12 col-lg-12">
        <div class="panel panel-default" id = "panel4">
            <div class="panel-heading">Code Team</div>
            <div class="panel-body" id="label">Team Leader: <p id="teamLeader"> </p> </div>
            <div class="panel-body" id="label">Nurse Preparing Meds:  <p id="nursePrep"> </p> </div>
            <div class="panel-body" id="label">Nurse Administering Meds: <p id="nurseAdmin"> </p> </div>
            <div class="panel-body" id="label">Recorder Nurse: <p id="nurseRecord"> </p> </div>
            <div class="panel-body" id="label">Anesthesiologist: <p id="anesthesiologist"> </p> </div>
            <div class="panel-body" id="label">Others: <p id="others1"> </p> <p id="others2"> </p> <p id="others3"> </p> <p id="others4"> </p> </div>
            </div>
            <button type="button" data-toggle = "modal" data-target= "#editModal" class="btn btn-primary edit-button" style="margin-left: 95.5%; margin-bottom: .5%" data-panel = "4">Edit</button>
        </div>
    </div>
</div>

<div class = "row row-three">
    <div class = "col-xs-12 col-sm-12 col-md-6 col-lg-6">
        <div class="panel panel-default" id = "panel5">
            <div class="panel-heading">Airway Control</div>
            <div class="panel-body">Incubation Time: <p></p></div>
            <div class="panel-body">ETT Size: <p></p></div>
            <div class="panel-body">Comments: <p></p></div>
            <div class="panel-footer">
            <button type="button" data-toggle = "modal" data-target= "#editModal" class="btn btn-primary edit-button" data-panel = "5">Edit</button>
            </div>
        </div>


    </div>
    <div class = "col-xs-12 col-sm-12 col-md-6 col-lg-6">
        <div class="panel panel-default" id = "panel6">
            <div class="panel-heading">IV Fluids</div>
            <div class="panel-body">Time Initiated: <p></p></div>
            <div class="panel-body">IV Site: <p></p></div>
            <div class="panel-body">IV Solution: <p></p></div>
            <div class="panel-body">IV Administrator: <p></p></div>
            <div class="panel-footer">
            <button type="button" data-toggle = "modal" data-target= "#editModal" class="btn btn-primary edit-button" data-panel = "6">Edit</button>
            </div>
        </div>


    </div>

</div>

<div class = "row row-three">
    <div class = "col-sm-12">
        <div class = "panel panel-default" id = "panel7">
        <div class = "panel-heading">Report Table</div>
        <div class = "panel-body">
            <div class = "table-wrapper-scroll-y">
                <table class = "table table-bordered table-striped">
                    <thead>
                        <tr>
                        <th scope = "col">Time</th>
                        <th scope = "col">Prescription</th>
                        <th scope = "col">Dose</th>
                        <th scope = "col">Rhythm</th>
                        <th scope = "col">Jules</th>
                        <th scope = "col">Comments</th>
                        </tr>
                    </thead>
                    <tbody contenteditable="true" id="info-table-body">
                        <tr>
                            <td>5;23</td>
                            <td>Epinephrine</td>
                            <td>5mm</td>
                            <td>120bpm</td>
                            <td>1100J</td>
                            <td>Doctor Comments</td>
                        </tr>
                    </tbody>
                </table>
            </div>

        </div>
            <div class="panel-footer">
            <button type="button" class="btn btn-warning add-row-btn" data-panel = "7" onclick = "addRow()">Add Row +</button>
            </div>

        </div>
    </div>
</div>

<div class = "row row-four">
    <div class = "col-sm-6">
        <div class = "panel panel-default" id = "panel8">
            <div class = "panel-heading">Comments:</div>
            <div class = "panel-body"><p>Comments about all the stuff</p></div>
            <div class="panel-footer">
            <button type="button" data-toggle = "modal" data-target= "#editModal" class="btn btn-primary edit-button" data-panel = "8">Edit</button>
            </div>
        </div>
    </div>
    
        <div class = "col-sm-6">
        <div class = "panel panel-default" id = "panel9">
            <div class = "panel-heading">Outcome:</div>
            <div class = "panel-body">The patient is: <p></p></div>
            <div class="panel-footer">
            <button type="button" data-toggle = "modal" data-target= "#editModal" class="btn btn-primary edit-button" data-panel = "9">Edit</button>
            </div>
        </div>
    </div>
</div>

<div class = "row row-five">
    <button onclick="printPage()" type = "button" class = "btn btn-warning print-button">Print</button>
    <button type = "button" class = "btn btn-warning save-button" data-toggle="modal" data-target = "#saveModal">Submit</button>
</div>

</div>
<script>
    function printPage(){
        window.print();
    }
</script>

<!-- The Modal -->
<div class="modal" id="saveModal">
  <div class="modal-dialog">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title">Warning!</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>

      <!-- Modal body -->
      <div class="modal-body modal-body-save">
        By Submitting this report you are stating that to the best of your knowledge all of the information is truthful and correct. Are you sure you want to submit?
      </div>

      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
        <button href = "home.html" type="button" class="btn" data-dismiss="modal">Submit</button>

      </div>

    </div>
  </div>
</div>

<div class="modal" id="editModal">
  <div class="modal-dialog">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title">Title</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>



      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal">Save</button>

      </div>

    </div>
  </div>
</div>

<script type = "text/javascript">
    var panelNumber;

$('#editModal').on('show.bs.modal', function (event) {
  var button = $(event.relatedTarget) // Button that triggered the modal
  var panelNum = button.data('panel')
  panelNumber = panelNum;
  var panel = document.getElementById("panel" + panelNum);
  var panElem = panel.children;
  var modal = $(this);

  var modalTitle = modal.find('.modal-title')
  var modalFoot = modal.find('.modal-footer');
  var modalContent = modal.find(".modal-content")
  var modalBody = document.createElement('div');
    modalBody.className = "modal-body modal-body-edit";
    modalContent.append(modalBody);

    modalFoot.insertAfter('.modal-body-edit');



 //set heading
  modal.find('.modal-title').text(panElem[0].innerHTML);

//set body
if(panelNumber != 8){
    var i;
    for(i = 1; i < (panElem.length-1); i++){
        //create a div
        var newdiv = document.createElement("div");

        var text = panElem[i].innerHTML;
        var textsplit = text.split(":");
        //console.log(textsplit);
        var label = document.createElement("label");
        label.addClass = "label"
        label.innerHTML = textsplit[0];
        var textbox = document.createElement("input");
        textbox.addClass = "input"
        var textForBox = panElem[i].children;
        console.log(textForBox[0].innerHTML);
        textbox.value = textForBox[0].innerHTML;
        //console.log(textsplit[1]);

        var span1 = document.createElement('span')
        span1.appendChild(label);
        span1.appendChild(textbox);
        newdiv.append(span1)
      modal.find('.modal-body').append(newdiv);
    };
} else {
    var textArea = document.createElement("textarea");
    var textElement = panElem[1].children;
    var text = textElement[0].innerHTML;
    textArea.innerHTML = text;
    textArea.addClass = "input";
    
    modal.find('.modal-body').append(textArea);
}
});

$('#editModal').on('hide.bs.modal', function (event){
    var modal = $(this);
    var divs = modal.find(".modal-body").children();

    var panel = document.getElementById("panel" + panelNumber);
    var panelElems = panel.children;
    console.log(panelElems);


    if(panelNumber != 8){
        var j;
        for(j = 0; j<divs.length;j++){
            var span = divs[j].children;
            var insideSpan = span[0].children;
            var labeltext = insideSpan[0].innerHTML;
            var inputtext = insideSpan[1].value;
            
            var newparaph = document.createElement("p");
            newparaph.innerHTML = inputtext;
            console.log(labeltext + ":" + inputtext);
            panelElems[j+1].innerHTML = labeltext + ":";
            panelElems[j+1].appendChild(newparaph);
        }
    } else {
        var textArea = divs[0].value;
        console.log(textArea);
        console.log(panelElems[1].innerHTML);
        panelElems[1].innerHTML = textArea;
    }

    modal.find(".modal-body").remove();

});

function addRow(){
    var tableBody = document.getElementById("info-table-body");
    console.log(tableBody)
    var newRow = document.createElement("tr");
    var i;
    for(i = 0; i < 6; i++){
        var newCell = document.createElement("td");
        newRow.appendChild(newCell);
    }
    tableBody.appendChild(newRow);
}
</script>





</body>
</html>
